import os
import pytest
from langchain_core.documents import Document

from helpers import convert_ai_msg_to_json 

def test_convert_ai_msg_to_json():
    data = {'context': [Document(page_content='decisions and documenta7on. The Trust ‘controls’ the ﬁnancials so the Trustees need to be in the loop once decisions about the Church’s future have been agreed. In a sense, the Church/ Members are beneﬁciaries of the Trust. The Trustees must act in the interests of the beneﬁciaries. Solicitor can clarify this. As Accountant with professional interests, Carla Grove should also be briefed and kept in the loop. Decision The par7es decide in principle what is preferred. The solicitor can advise in the event of conﬂict.', metadata={'page': 1.0, 'source': '/tmp/Action_plan_for_parking_the_Church_II_2.pdf'}), Document(page_content='Financials and ﬁling returnsCarla Grove (Christchurch) should be kept in the loop. She is the formal Accountant and responsible for ﬁling of various returns with IRD and Chari7es, and deregistering GST process. She is also the ‘subscriber’ to Xero so will need to synchronise the ﬁnal ﬁnancials and dissolu7on with cancelling the Xero subscrip7on. Documenta7on Seemingly, the documenta7on will mainly be resolu7ons of the four en77es passed in the right order, preferably draQed by the solicitor; otherwise approved by the solicitor. Since rela7onships link the par7es in the process, the solicitor might want to recognise some links in the respec7ve minutes. Other documenta7on/ communica7ons will include some or all of Chari7es Services, Companies Oﬃce (re Board), IRD, Landlord, Bank, and Members, plus any returns that need to be ﬁled. Bank accounts The Church has established several bank accounts over 7me, as follows, with approximate funds on 24 June: oTrading:                    $6,976', metadata={'page': 4.0, 'source': '/tmp/Action_plan_for_parking_the_Church_II_2.pdf'}), Document(page_content='and possibly some others, at the start: 1)Agree the brief and the process: Conﬁrm what needs to be done, the order of doing it, and synchronise the 7ming. 1)Deciding what to do with the Trust: Dependent on the stakeholders agreeing.  Seemingly best to wind it up. 2)Transferring funds from overseas (Harbour Presbyterian Church) to David.  3)Treatment of funds held in Diaconate, Missions, and Church Plan7ng accounts: Whilst these have been allocated to these purposes, whether they can be freely transferred back to the Trading account and used for other purposes. 4)Ves7ng the funds to an en7ty to hold and manage: The trust deed sets out how the Trustees are to distribute the funds. 5)Treatment of funds designated for acquisi7on of a property: Whether the designated purpose can be ‘released’ when vested pursuant to the provisions in the deed. 6)Records to be retained aQer ‘parking’ or disestablishing the Church: What records and who should retain. Timing Seemingly, the process can be', metadata={'page': 2.0, 'source': '/tmp/Action_plan_for_parking_the_Church_II_2.pdf'}), Document(page_content='Authorised persons Appoint Authorised Persons to manage the process and brief the solicitor.  The Trust will also need oﬃcers delegated to carry out certain ac7vi7es, probably two Trustees with signing authority. Ac7vi7es will include: oRealising or dealing with physical assets such as sound system and kitchen equipment. oPaying ﬁnal bills, including solicitor. oVes7ng assets oClosing the bank accounts. Note: Hopefully, no changes of trustees. Any changes of trustees must be registered with Chari7es Services. Brief solicitor Agree the brief with the solicitor to ensure everyone is on the same page and the process is eﬃcient. This will help contain the cost. ‘The right thing, the right way, at the right 7me.’ Legal advice on technical issues – at the start Seek legal advice on these issues, and possibly some others, at the start: 1)Agree the brief and the process: Conﬁrm what needs to be done, the order of doing it, and synchronise the 7ming. 1)Deciding what to do with the Trust:', metadata={'page': 2.0, 'source': '/tmp/Action_plan_for_parking_the_Church_II_2.pdf'})], 'question': 'Who controls the financials?', 'answer': [{'answer': "The Trust 'controls' the financials so the Trustees need to be in the loop once decisions about the Church’s future have been agreed.", 'citations': [0]}]}
    output = convert_ai_msg_to_json(data)
    print(output)